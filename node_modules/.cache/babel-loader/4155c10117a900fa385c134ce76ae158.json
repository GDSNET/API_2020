{"ast":null,"code":"var DEFAULT_POLICY = 'no-referrer';\nvar ALLOWED_POLICIES = ['no-referrer', 'no-referrer-when-downgrade', 'same-origin', 'origin', 'strict-origin', 'origin-when-cross-origin', 'strict-origin-when-cross-origin', 'unsafe-url', ''];\nvar ALLOWED_POLICIES_ERROR_LIST = ALLOWED_POLICIES.map(function (policy) {\n  if (policy.length) {\n    return '\"' + policy + '\"';\n  } else {\n    return 'and the empty string';\n  }\n}).join(', ');\n\nmodule.exports = function referrerPolicy(options) {\n  options = options || {};\n  var policy;\n\n  if ('policy' in options) {\n    policy = options.policy;\n  } else {\n    policy = DEFAULT_POLICY;\n  }\n\n  if (ALLOWED_POLICIES.indexOf(policy) === -1) {\n    throw new Error('\"' + policy + '\" is not a valid policy. Allowed policies: ' + ALLOWED_POLICIES_ERROR_LIST + '.');\n  }\n\n  return function referrerPolicy(req, res, next) {\n    res.setHeader('Referrer-Policy', policy);\n    next();\n  };\n};","map":null,"metadata":{},"sourceType":"script"}