{"ast":null,"code":"module.exports = function xXssProtection(options) {\n  options = options || {};\n  var headerValue = '1; mode=block';\n\n  if (options.reportUri) {\n    headerValue += '; report=' + options.reportUri;\n  }\n\n  if (options.setOnOldIE) {\n    return function xXssProtection(req, res, next) {\n      res.setHeader('X-XSS-Protection', headerValue);\n      next();\n    };\n  } else {\n    return function xXssProtection(req, res, next) {\n      var matches = /msie\\s*(\\d+)/i.exec(req.headers['user-agent']);\n      var value;\n\n      if (!matches || parseFloat(matches[1]) >= 9) {\n        value = headerValue;\n      } else {\n        value = '0';\n      }\n\n      res.setHeader('X-XSS-Protection', value);\n      next();\n    };\n  }\n};","map":null,"metadata":{},"sourceType":"script"}