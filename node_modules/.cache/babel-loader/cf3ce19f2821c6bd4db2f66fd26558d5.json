{"ast":null,"code":"var DEFAULT_PERMITTED_POLICIES = 'none';\nvar ALLOWED_POLICIES = ['none', 'master-only', 'by-content-type', 'all'];\n\nmodule.exports = function crossdomain(options) {\n  options = options || {};\n  var permittedPolicies;\n\n  if ('permittedPolicies' in options) {\n    permittedPolicies = options.permittedPolicies;\n  } else {\n    permittedPolicies = DEFAULT_PERMITTED_POLICIES;\n  }\n\n  if (ALLOWED_POLICIES.indexOf(permittedPolicies) === -1) {\n    throw new Error('\"' + permittedPolicies + '\" is not a valid permitted policy. Allowed values: ' + ALLOWED_POLICIES.join(', ') + '.');\n  }\n\n  return function crossdomain(req, res, next) {\n    res.setHeader('X-Permitted-Cross-Domain-Policies', permittedPolicies);\n    next();\n  };\n};","map":null,"metadata":{},"sourceType":"script"}